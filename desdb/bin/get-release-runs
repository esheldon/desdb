#!/usr/bin/env python
"""
    %prog [options] release

Print all runs for input release.

Examples are
    
    Y1C1_FINALCUT_PRERELEASE: reduced images/catalogs for y1c1 prerelease
    Y1C1_COADD_PRERELEASE: coadd images/catalogs for y1c1 prerelease
"""

import os
import sys
from sys import stdout,stderr
import desdb

from optparse import OptionParser
parser=OptionParser(__doc__)
parser.add_option("-u","--user",default=None, help="Username.")
parser.add_option("-p","--password",default=None, help="Password.")
parser.add_option("--host",default=None, help="over-ride default host")

parser.add_option("-s","--show", action='store_true', help="Show the query on stderr.")

def main():

    options,args = parser.parse_args(sys.argv[1:])

    if len(args) < 1:
        parser.print_help()
        sys.exit(45)

    conn=desdb.Connection(user=options.user,
                          password=options.password,
                          host=options.host)

    release=args[0].strip()

    query="""
    select distinct(run) from runtag where tag='%s'
    """ % release

    res=conn.quick(query,show=options.show)
    for r in res:
        print r['run']

if __name__=="__main__":
    main()
