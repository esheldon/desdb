#!/usr/bin/env python
"""
    %prog [options] release

Print all runs for input release.

Examples are
    
    Y1C1_FINALCUT_PRERELEASE: reduced images/catalogs for y1c1 prerelease
    Y1C1_COADD_PRERELEASE: coadd images/catalogs for y1c1 prerelease
"""

import os
import sys
from sys import stdout,stderr
import desdb

from optparse import OptionParser
parser=OptionParser(__doc__)
parser.add_option("-u","--user",default=None, help="Username.")
parser.add_option("-p","--password",default=None, help="Password.")
parser.add_option("--host",default=None, help="over-ride default host")

parser.add_option("-s","--show", action='store_true', help="Show the query on stderr.")

parser.add_option("--withbands", default=None,
                  help="require these bands")

def main():

    options,args = parser.parse_args(sys.argv[1:])

    if len(args) < 1:
        parser.print_help()
        sys.exit(45)

    release=args[0].split(',')

    withbands=options.withbands
    if withbands is not None:
        withbands=withbands.split(',')


    runs=desdb.files.get_release_runs(release,
                                      withbands=withbands,
                                      user=options.user,
                                      password=options.password,
                                      host=options.host,
                                      show=options.show)
    for r in runs:
        print r

if __name__=="__main__":
    main()
