#!/usr/bin/env python
"""
    %prog [options]

Take the query on standard input, or via the -q parameter write the results on
standard output.
"""

import sys
from sys import stdin,stdout
import desdb


from optparse import OptionParser
parser=OptionParser(__doc__)
parser.add_option("-q","--query",default=None, help="The query, overriding stdin.")
parser.add_option("-u","--user",default=None, help="Username.")
parser.add_option("-p","--password",default=None, help="Password.")
parser.add_option("-s","--show",action='store_true', help="Show query on stderr.")
parser.add_option("-f","--format",default='csv',
    help=("File format for output.  csv,json,cjson,pyobj,pretty."
          "Default %default."))

def main():

    options,args = parser.parse_args(sys.argv[1:])

    query=options.query
    if options.query is None:
        query = stdin.read()

    conn=desdb.Connection(user=options.user,password=options.password)
    res=conn.quickWrite(query,show=options.show,fmt=options.format)

if __name__=="__main__":
    main()
